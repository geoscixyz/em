.. _time_domain_magnetic_dipole_analytic_solution:

Analytic Solution
=================

.. purpose::

    Here, we present a formulation for predicting the electric and magnetic fields generated by a transient magnetic dipole source.
    This is accomplished by applying the inverse Laplace transform to frequency domain solutions for the harmonic magnetic dipole.
    Analytic expressions for the electric field, the magnetic field and the corresponding vector potential are provided.
    Due to the difficulties which arise in deriving the final expressions, we will not include the effects of dielectric permittivity (:math:`\varepsilon`); this is known as the quasi-static approximation.
    


**Obtaining the Transient Response from a Harmonic Solution**


For a causal system, the unit step-response (:math:`g_+`) at :math:`t \geq 0` is given by:

.. math::
	g_+(t) = \int_{-\infty}^\infty f(\tau) u(t - \tau) d\tau = \int_0^t f(\tau) d\tau \; \; \; \textrm{for} \; \; \; t\geq 0
	:label: causal_step

where :math:`f(t)` is the system's impulse response.
For most geophysical problems however, we are interested in the step-off or transient response (:math:`g_-`).
The step-off response for a causal system may be given by:

.. math::
	\begin{split}
	g_-(t) = \int_{-\infty}^\infty f(\tau) \big [ 1 - &u(t - \tau) \big ] d\tau = \; ... \\
	& \int_0^\infty f(\tau) d\tau - \int_0^t f(\tau) d\tau = g_+ (\infty) - g_+(t) \; \; \; \textrm{for} \; \; \; t\geq 0
	\end{split}
	:label: causal_step_off

where :math:`g_+ (\infty )` represents the step-response at :math:`t = \infty`.
Therefore, if the step-response is known for :math:`t \geq 0`, it can be used to obtain the step-off response at :math:`t \geq 0`.

From Ward and Hohmann :cite:`ward1988`, the step-response can be obtained via the following inverse Laplace transform:

.. math::
	g_+(t) = L^{-1} \Bigg [ \frac{F(s)}{s} \Bigg ]
	:label: step_Laplace_transform

where :math:`F(s)` is obtained by replacing :math:`s=i\omega` in the system's harmonic response function.
For the electric field, magnetic field and vector potential arising from a harmonic magnetic dipole in the :math:`\mathbf{\hat x}` direction, these have :ref:`already been derived<frequency_domain_magnetic_dipole_analytic_solution>`.


**Harmonic Solutions for a Magnetic Dipole**

As we just mentionned, harmonic solutions for the electric field, magnetic field and vector potential have :ref:`already been derived<frequency_domain_magnetic_dipole_analytic_solution>` for a source term :math:`\mathbf{J_m^s} = -i\omega IS \delta (x) \delta (y) \delta (z)` \mathbf{\hat x}. 


For the vector potential:

.. math::
	{\bf F}(i\omega ) = \frac{i\omega \mu m}{4\pi r} e^{-ikr} \mathbf{\hat x}
	:label: F_harmonic_response


For the electric field:

.. math::
	{\bf E_m}(i\omega ) = \frac{i\omega \mu m}{4\pi r^2} (ikr +1) e^{-ikr} \Bigg ( \frac{z}{r}\mathbf{\hat y} - \frac{y}{r}\mathbf{\hat z}  \Bigg )
	:label: E_harmonic_response

And for the magnetic field:

.. math::
	{\bf H_m}(i\omega ) = \frac{m}{4\pi r^3} e^{-ikr} \Bigg [ \Bigg ( \frac{x^2}{r^2}\mathbf{\hat x} + \frac{xy}{r^2}\mathbf{\hat y} + \frac{xz}{r^2} \mathbf{\hat z} \Bigg ) \big ( -k^2 r^2 + 3ikr +3 \big ) + \big ( k^2 r^2 -ikr -1 \big ) \mathbf{\hat x} \Bigg ]
	:label: H_harmonic_response

where the wavenumber :math:`k` is given by:

.. math::
	k = \big ( \omega^2\mu\varepsilon - i \omega \mu \sigma \big )^{1/2}
	:label: wave_number



**Analytic Solutions for the Transient Response (Quasi-Static)**


Due to the difficulties which arise in deriving the final expressions, we will not include the effects of dielectric permittivity (:math:`\varepsilon`); this is known as the quasi-static approximation. In the quasi-static regime (i.e. when :math:`|\omega\varepsilon \ll \sigma |`), the wavenumber is given by:

.. math::
	k = \big (- i \omega \mu \sigma \big )^{1/2}
	:label: wave_number_quasi_static

If we substitute :math:`s = i\omega` in Eqs. :eq:`F_harmonic_response`, :eq:`E_harmonic_response` and :eq:`H_harmonic_response` and divide by :math:`s` then:


.. math::
	\frac{{\bf F}(s)}{s} = \frac{\mu m}{4 \pi r} e^{- \sqrt{s \mu\sigma r^2}} \mathbf{\hat x} \; ,
	:label: A_frac_inverse_Laplace



.. math::
	\frac{{\bf E_m}(s)}{s} = s \Bigg [ \frac{\mu m}{4\pi r^3} \bigg ( \sqrt{\frac{ \mu \sigma}{s}} r + \frac{1}{s} \bigg ) e^{-\sqrt{s \mu \sigma r^2}} \big ( z \, \mathbf{\hat y} - y\, \mathbf{\hat z}  \big ) \Bigg ]
	:label: E_frac_inverse_Laplace

and

.. math::
	\begin{split}
	\frac{{\bf H_m}(s)}{s} = \frac{m}{4\pi r^3} & e^{-\sqrt{s\mu \sigma r^2}} \Bigg [ \Bigg ( \frac{x^2}{r^2}\mathbf{\hat x} +  \frac{xy}{r^2}\mathbf{\hat y} + \frac{xz}{r^2} \mathbf{\hat z} \Bigg ) \; ... \\
	& \Bigg ( -\mu\sigma r^2 + 3 \sqrt{\frac{\mu \sigma}{s}}r + \frac{3}{s} \Bigg ) + \Bigg ( -\mu\sigma r^2 - \sqrt{\frac{\mu \sigma}{s}} r - \frac{1}{s} \Bigg ) \mathbf{\hat x} \Bigg ]
	\end{split}
	:label: H_frac_inverse_Laplace


The inverse Laplace transform of the previous three expressions, and thus the step-response, can be derived by using the following identities (Abramowitz and Stegun, 1964):


.. math::
	L^{-1} \Big [ s F(s) \Big ] = \frac{d}{dt} f(t)

.. math::
	L^{-1} \Big [ e^{-\alpha \sqrt{s}} \Big ] = \frac{\alpha}{2\sqrt{\pi t^3}} e^{-\alpha^2/4t} \;\;\; \textrm{for} \; \; \; \alpha > 0 \\
	:label: inverse_Laplace_identity_2

.. math::
	L^{-1} \Bigg [ \frac{1}{\sqrt{s}} e^{-\alpha \sqrt{s}} \Bigg ] = \frac{1}{\sqrt{\pi t}} e^{-\alpha^2/4t} \;\;\; \textrm{for} \; \; \; \alpha \geq 0 \\
	:label: inverse_Laplace_identity_3

.. math::
	L^{-1} \Bigg [ \frac{1}{s} e^{-\alpha \sqrt{s}} \Bigg ] = \textrm{erfc}\Bigg ( \frac{\alpha}{2\sqrt{t}} \Bigg )\;\;\; \textrm{for} \; \; \; \alpha \geq 0
	:label: inverse_Laplace_identity_4


where erfc(x) is the complimentary error function.
Thus:

.. math::
	L^{-1} \Bigg [ \frac{{\bf F}(s)}{s} \Bigg ] = \frac{m\theta^3}{\pi^{3/2} \sigma} e^{-\theta^2 r^2} \mathbf{\hat x} \; ,
	:label: a_step_response



.. math::
	L^{-1}\Bigg [ \frac{{\bf E_m}(s)}{s} \Bigg ] = \frac{2 m \theta^5 }{\pi^{3/2} \sigma} e^{-\theta^2 r^2} \big ( z \, \mathbf{\hat y} - y \, \mathbf{\hat z} \big )
	:label: e_step_response


and

.. math::
	\begin{split}
	L^{-1}\Bigg [ \frac{{\bf H_m}(s)}{s} \Bigg ] = \frac{m}{4\pi r^3} \Bigg [ & \Bigg ( \frac{x^2}{r^2}\mathbf{\hat x} + \frac{xy}{r^2}\mathbf{\hat y} + \frac{xz}{r^2}\mathbf{\hat z} \Bigg ) \Bigg ( \bigg ( \frac{4}{\sqrt{\pi}} \theta^3 r^3 + \frac{6}{\sqrt{\pi}} \theta r \bigg ) e^{-\theta^2 r^2}  \, ...  \\
	& + 3\, \textrm{erfc} (\theta r) \Bigg ) - \Bigg ( \bigg ( \frac{4}{\sqrt{\pi}} \theta^3 r^3 + \frac{2}{\sqrt{\pi}} \theta r \bigg ) e^{-\theta^2 r^2} +  \textrm{erfc} (\theta r) \Bigg ) \mathbf{\hat x} \Bigg ]
	\end{split}
	:label: h_step_response

where

.. math::
	\theta = \Bigg ( \frac{\mu\sigma}{4t} \Bigg )^{1/2}
	:label: theta_quasi_static


Using the previous three expressions, we can determine the transient vector potential, electric field magnetic fields according to Eq. :eq:`causal_step_off`.
For the vector potential, the transient response is given by:


.. math::
	{\bf f}(t) = -\frac{m \theta^3}{\pi^{3/2} \sigma} e^{-\theta^2 r^2} \mathbf{\hat x}
	:label: vector_potential_step_off


For the electric field, the transient response is given by:


.. math::
	{\bf e_m}(t) = \frac{2 m \theta^5 }{\pi^{3/2} \sigma} e^{-\theta^2 r^2} \big ( -z \, \mathbf{\hat y} + y \, \mathbf{\hat z} \big )
	:label: e_step_off_response

where erf(:math:`x`) is the error function.
And for the magnetic field, the transient response is given by:

.. math::
	\begin{split}
	{\bf h_m}(t) = \frac{m}{4\pi r^3} \Bigg [ & \Bigg ( \frac{x^2}{r^2} \mathbf{\hat x} + \frac{xy}{r^2}\mathbf{\hat y} + \frac{xz}{r^2} \mathbf{\hat z} \Bigg ) \Bigg ( 3 \, \textrm{erf}(\theta r) - \bigg ( \frac{4}{\sqrt{\pi}}\theta^3 r^3  \; ... \\ 
	&+ \frac{6}{\sqrt{\pi}}\theta r \bigg ) e^{-\theta^2 r^2} \Bigg ) - \Bigg (\textrm{erf}(\theta r) - \bigg ( \frac{4}{\sqrt{\pi}}\theta^3 r^3 + \frac{2}{\sqrt{\pi}}\theta r \bigg ) e^{-\theta^2 r^2} \Bigg ) \mathbf{\hat x}  \Bigg ]
	\end{split}
	:label: h_step_off_response


For geophysical applications, we generally measure the electromotive force induced within a receiver coil.
As a result, we are interested in the time-rate of decay of the magnetic field.
Taking the derivative of Eq. :eq:`h_step_off_response`, this is given by:

.. math::
	\frac{\partial{ \bf h_m}}{\partial t} = - \frac{4m \theta^5}{\pi^{3/2} \mu\sigma} e^{-\theta^2 r^2} \Bigg [ \Bigg ( \frac{x^2}{r^2}\mathbf{\hat x} + \frac{xy}{r^2} \mathbf{\hat y} + \frac{xz}{r^2} \mathbf{\hat z} \Bigg ) \theta^2 r^2  + \big (1 -\theta^2 r^2 \big ) \mathbf{\hat x} \Bigg ]
	:label: dhdt_step_off_quasi_static
